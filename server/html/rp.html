<!doctype html>
<html ng-app="rpnow">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, height=device-height, maximum-scale=1, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <title>The Grim Grotto</title>

  <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic">
  <link rel="stylesheet" href="/rp.css">
</head>

<body ng-cloak ng-controller="RpController">

  <div layout="column" style="height:100%">
    <md-toolbar flex="none" class="md-hue-2" style="box-shadow: 0 0 4px rgba(0,0,0,.14),0 4px 8px rgba(0,0,0,.28); ">
      <div class="md-toolbar-tools noselect">
        <md-button class="md-icon-button" aria-label="Menu" title="Menu">
          <md-icon>menu</md-icon>
        </md-button>
        <h1>
          <span title="{{rp.title}}">{{rp.title.substr(0,10)}}</span>
        </h1>
        <span flex></span>
        <md-button class="md-icon-button" aria-label="Invite" title="Invite">
          <md-icon>mail</md-icon>
        </md-button>
        <md-button class="md-icon-button" aria-label="Read archive" title="Read archive">
          <md-icon>import_contacts</md-icon>
        </md-button>
        <md-button class="md-icon-button" aria-label="More options" title="More options">
          <md-icon>more_vert</md-icon>
        </md-button>
      </div>
    </md-toolbar>

    <md-content flex layout="column" layout-padding>
      <div ng-repeat="msg in rp.msgs.slice(-20)" class="message message-{{msg.type}}" ng-style="{'background-color': msg.chara?msg.chara.color:'auto', 'opacity':msg.sending?0.5:1}">
        <div ng-if="msg.type === 'chara'" class="name">{{msg.chara.name}}</div>
        <div class="message-details">
          <span class="color-ip-box" title="User color ID">
            <span ng-style="{'background-color':'#'+msg.ipid.substr(0,6)}"></span><!--
            --><span ng-style="{'background-color':'#'+msg.ipid.substr(6,6)}"></span><!--
            --><span ng-style="{'background-color':'#'+msg.ipid.substr(12,6)}"></span>
          </span>
          <span class="timestamp" title="Posted {{msg.timestamp | momentAgo}}">{{msg.timestamp | momentAgo}}</span>
        </div>
        <div class="content">
          {{msg.content | msgContent}}
        </div>
      </div>
    </md-content>

    <div flex="noshrink" layout="row" layout-align="center center" style="box-shadow: 0 0 4px rgba(0,0,0,.14),0 -4px 8px rgba(0,0,0,.28); z-index: 1; background-color:#eee;" >
      <textarea rows="2" flex flex-gt-sm="60" style="border:none;background-color:inherit; color:inherit;margin:5px;padding:10px; line-height: 1.4" placeholder="Type your message."></textarea>
      <div flex="none">
        <md-button class="md-icon-button" aria-label="Send" title="Send">
          <md-icon>send</md-icon>
        </md-button>
      </div>
    </div>
  </div>
  
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.js"></script>
  <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

  <script src="/rp.js"></script>
</body>
</html>